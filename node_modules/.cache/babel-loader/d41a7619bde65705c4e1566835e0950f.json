{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\38093\\\\Desktop\\\\\\u041D\\u043E\\u0432\\u0430 \\u043F\\u0430\\u043F\\u043A\\u0430\\\\1\\\\real-estate-test-task\\\\src\\\\components\\\\Map\\\\Map.jsx\",\n    _s = $RefreshSig$();\n\nimport { MapContainer, TileLayer, useMap } from \"react-leaflet\";\nimport { latLng } from \"leaflet\";\nimport { useEffect, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Markers from \"../Markers\";\nimport Posts from \"../Posts\";\nimport { updatePosts } from \"../../store/postsInAreaReducer\";\nimport { getCoords } from \"../../store/coordsReducer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MapControl() {\n  _s();\n\n  const dispatch = useDispatch();\n  const currentPosts = useSelector(state => state.currentPosts.currentPosts);\n  const map = useMap();\n  const onMove = useCallback(() => {\n    const bounds = map.getBounds();\n    const inArea = [];\n    currentPosts.forEach(post => {\n      const pos = latLng(post.coord[0], post.coord[1]);\n\n      if (bounds.contains(pos)) {\n        inArea.push(post);\n      }\n    });\n    dispatch(updatePosts(inArea));\n  }, [map, currentPosts]);\n  const onClick = useCallback(e => {\n    let newCoord = [e.latlng.lat, e.latlng.lng];\n    dispatch(getCoords(newCoord));\n  }, []);\n  useEffect(() => {\n    map.on(\"move\", onMove);\n    map.on(\"click\", onClick);\n    return () => {\n      map.off(\"move\", onMove);\n      map.off(\"click\", onClick);\n    };\n  }, [map, onMove]);\n}\n\n_s(MapControl, \"fkMdeClFMw4Mk5Fm0rfjGt/ps54=\", false, function () {\n  return [useDispatch, useSelector, useMap];\n});\n\n_c = MapControl;\n\nfunction Map() {\n  const position = [50.444, 30.581];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-container\",\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: position,\n      zoom: 11,\n      scrollWheelZoom: true,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Markers, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapControl, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Posts, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n\n_c2 = Map;\nexport default Map;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MapControl\");\n$RefreshReg$(_c2, \"Map\");","map":{"version":3,"names":["MapContainer","TileLayer","useMap","latLng","useEffect","useCallback","useDispatch","useSelector","Markers","Posts","updatePosts","getCoords","MapControl","dispatch","currentPosts","state","map","onMove","bounds","getBounds","inArea","forEach","post","pos","coord","contains","push","onClick","e","newCoord","latlng","lat","lng","on","off","Map","position"],"sources":["C:/Users/38093/Desktop/Нова папка/1/real-estate-test-task/src/components/Map/Map.jsx"],"sourcesContent":["import { MapContainer, TileLayer, useMap } from \"react-leaflet\";\r\nimport { latLng } from \"leaflet\";\r\nimport { useEffect, useCallback } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport Markers from \"../Markers\";\r\nimport Posts from \"../Posts\";\r\nimport { updatePosts } from \"../../store/postsInAreaReducer\";\r\nimport { getCoords } from \"../../store/coordsReducer\";\r\n\r\nfunction MapControl() {\r\n  const dispatch = useDispatch();\r\n  const currentPosts = useSelector((state) => state.currentPosts.currentPosts);\r\n  const map = useMap();\r\n\r\n  const onMove = useCallback(() => {\r\n    const bounds = map.getBounds();\r\n    const inArea = [];\r\n    currentPosts.forEach((post) => {\r\n      const pos = latLng(post.coord[0], post.coord[1]);\r\n      if (bounds.contains(pos)) {\r\n        inArea.push(post);\r\n      }\r\n    });\r\n    dispatch(updatePosts(inArea));\r\n  }, [map, currentPosts]);\r\n\r\n  const onClick = useCallback((e) => {\r\n    let newCoord = [e.latlng.lat, e.latlng.lng];\r\n    dispatch(getCoords(newCoord));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    map.on(\"move\", onMove);\r\n    map.on(\"click\", onClick);\r\n    return () => {\r\n      map.off(\"move\", onMove);\r\n      map.off(\"click\", onClick);\r\n    };\r\n  }, [map, onMove]);\r\n}\r\n\r\nfunction Map() {\r\n  const position = [50.444, 30.581];\r\n  return (\r\n    <div className=\"map-container\">\r\n      <MapContainer center={position} zoom={11} scrollWheelZoom={true}>\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n        <Markers />\r\n        <MapControl />\r\n      </MapContainer>\r\n      <Posts />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Map;\r\n"],"mappings":";;;AAAA,SAASA,YAAT,EAAuBC,SAAvB,EAAkCC,MAAlC,QAAgD,eAAhD;AACA,SAASC,MAAT,QAAuB,SAAvB;AACA,SAASC,SAAT,EAAoBC,WAApB,QAAuC,OAAvC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,SAASC,WAAT,QAA4B,gCAA5B;AACA,SAASC,SAAT,QAA0B,2BAA1B;;;AAEA,SAASC,UAAT,GAAsB;EAAA;;EACpB,MAAMC,QAAQ,GAAGP,WAAW,EAA5B;EACA,MAAMQ,YAAY,GAAGP,WAAW,CAAEQ,KAAD,IAAWA,KAAK,CAACD,YAAN,CAAmBA,YAA/B,CAAhC;EACA,MAAME,GAAG,GAAGd,MAAM,EAAlB;EAEA,MAAMe,MAAM,GAAGZ,WAAW,CAAC,MAAM;IAC/B,MAAMa,MAAM,GAAGF,GAAG,CAACG,SAAJ,EAAf;IACA,MAAMC,MAAM,GAAG,EAAf;IACAN,YAAY,CAACO,OAAb,CAAsBC,IAAD,IAAU;MAC7B,MAAMC,GAAG,GAAGpB,MAAM,CAACmB,IAAI,CAACE,KAAL,CAAW,CAAX,CAAD,EAAgBF,IAAI,CAACE,KAAL,CAAW,CAAX,CAAhB,CAAlB;;MACA,IAAIN,MAAM,CAACO,QAAP,CAAgBF,GAAhB,CAAJ,EAA0B;QACxBH,MAAM,CAACM,IAAP,CAAYJ,IAAZ;MACD;IACF,CALD;IAMAT,QAAQ,CAACH,WAAW,CAACU,MAAD,CAAZ,CAAR;EACD,CAVyB,EAUvB,CAACJ,GAAD,EAAMF,YAAN,CAVuB,CAA1B;EAYA,MAAMa,OAAO,GAAGtB,WAAW,CAAEuB,CAAD,IAAO;IACjC,IAAIC,QAAQ,GAAG,CAACD,CAAC,CAACE,MAAF,CAASC,GAAV,EAAeH,CAAC,CAACE,MAAF,CAASE,GAAxB,CAAf;IACAnB,QAAQ,CAACF,SAAS,CAACkB,QAAD,CAAV,CAAR;EACD,CAH0B,EAGxB,EAHwB,CAA3B;EAKAzB,SAAS,CAAC,MAAM;IACdY,GAAG,CAACiB,EAAJ,CAAO,MAAP,EAAehB,MAAf;IACAD,GAAG,CAACiB,EAAJ,CAAO,OAAP,EAAgBN,OAAhB;IACA,OAAO,MAAM;MACXX,GAAG,CAACkB,GAAJ,CAAQ,MAAR,EAAgBjB,MAAhB;MACAD,GAAG,CAACkB,GAAJ,CAAQ,OAAR,EAAiBP,OAAjB;IACD,CAHD;EAID,CAPQ,EAON,CAACX,GAAD,EAAMC,MAAN,CAPM,CAAT;AAQD;;GA9BQL,U;UACUN,W,EACIC,W,EACTL,M;;;KAHLU,U;;AAgCT,SAASuB,GAAT,GAAe;EACb,MAAMC,QAAQ,GAAG,CAAC,MAAD,EAAS,MAAT,CAAjB;EACA,oBACE;IAAK,SAAS,EAAC,eAAf;IAAA,wBACE,QAAC,YAAD;MAAc,MAAM,EAAEA,QAAtB;MAAgC,IAAI,EAAE,EAAtC;MAA0C,eAAe,EAAE,IAA3D;MAAA,wBACE,QAAC,SAAD;QACE,WAAW,EAAC,yFADd;QAEE,GAAG,EAAC;MAFN;QAAA;QAAA;QAAA;MAAA,QADF,eAKE,QAAC,OAAD;QAAA;QAAA;QAAA;MAAA,QALF,eAME,QAAC,UAAD;QAAA;QAAA;QAAA;MAAA,QANF;IAAA;MAAA;MAAA;MAAA;IAAA,QADF,eASE,QAAC,KAAD;MAAA;MAAA;MAAA;IAAA,QATF;EAAA;IAAA;IAAA;IAAA;EAAA,QADF;AAaD;;MAfQD,G;AAiBT,eAAeA,GAAf"},"metadata":{},"sourceType":"module"}