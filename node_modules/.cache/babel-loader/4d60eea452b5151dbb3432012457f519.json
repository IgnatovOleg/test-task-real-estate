{"ast":null,"code":"import{MapContainer,TileLayer,useMap}from\"react-leaflet\";import{latLng}from\"leaflet\";import{useEffect,useCallback}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import\"../Map/Map.scss\";import Markers from\"../Markers\";import Posts from\"../Posts\";import{updatePosts}from\"../../store/postsInAreaReducer\";import{getCoords}from\"../../store/coordsReducer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MapControl(){var dispatch=useDispatch();var currentPosts=useSelector(function(state){return state.currentPosts.currentPosts;});var map=useMap();var onMove=useCallback(function(){var bounds=map.getBounds();var inArea=[];currentPosts.forEach(function(post){var pos=latLng(post.coord[0],post.coord[1]);if(bounds.contains(pos)){inArea.push(post);}});dispatch(updatePosts(inArea));},[map,currentPosts]);var onClick=useCallback(function(e){var newCoord=[e.latlng.lat,e.latlng.lng];dispatch(getCoords(newCoord));},[]);useEffect(function(){map.on(\"move\",onMove);map.on(\"click\",onClick);return function(){map.off(\"move\",onMove);map.off(\"click\",onClick);};},[map,onMove]);}function Map(){var position=[50.444,30.581];return/*#__PURE__*/_jsxs(\"div\",{className:\"map-container\",children:[/*#__PURE__*/_jsxs(MapContainer,{center:position,zoom:11,scrollWheelZoom:true,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(Markers,{}),/*#__PURE__*/_jsx(MapControl,{})]}),/*#__PURE__*/_jsx(Posts,{})]});}export default Map;","map":{"version":3,"names":["MapContainer","TileLayer","useMap","latLng","useEffect","useCallback","useDispatch","useSelector","Markers","Posts","updatePosts","getCoords","MapControl","dispatch","currentPosts","state","map","onMove","bounds","getBounds","inArea","forEach","post","pos","coord","contains","push","onClick","e","newCoord","latlng","lat","lng","on","off","Map","position"],"sources":["C:/Users/38093/Desktop/Нова папка/1/real-estate-test-task/src/components/Map/Map.jsx"],"sourcesContent":["import { MapContainer, TileLayer, useMap } from \"react-leaflet\";\r\nimport { latLng } from \"leaflet\";\r\nimport { useEffect, useCallback } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport \"../Map/Map.scss\"\r\nimport Markers from \"../Markers\";\r\nimport Posts from \"../Posts\";\r\nimport { updatePosts } from \"../../store/postsInAreaReducer\";\r\nimport { getCoords } from \"../../store/coordsReducer\";\r\n\r\nfunction MapControl() {\r\n  const dispatch = useDispatch();\r\n  const currentPosts = useSelector((state) => state.currentPosts.currentPosts);\r\n  const map = useMap();\r\n\r\n  const onMove = useCallback(() => {\r\n    const bounds = map.getBounds();\r\n    const inArea = [];\r\n    currentPosts.forEach((post) => {\r\n      const pos = latLng(post.coord[0], post.coord[1]);\r\n      if (bounds.contains(pos)) {\r\n        inArea.push(post);\r\n      }\r\n    });\r\n    dispatch(updatePosts(inArea));\r\n  }, [map, currentPosts]);\r\n\r\n  const onClick = useCallback((e) => {\r\n    let newCoord = [e.latlng.lat, e.latlng.lng];\r\n    dispatch(getCoords(newCoord));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    map.on(\"move\", onMove);\r\n    map.on(\"click\", onClick);\r\n    return () => {\r\n      map.off(\"move\", onMove);\r\n      map.off(\"click\", onClick);\r\n    };\r\n  }, [map, onMove]);\r\n}\r\n\r\nfunction Map() {\r\n  const position = [50.444, 30.581];\r\n  return (\r\n    <div className=\"map-container\">\r\n      <MapContainer center={position} zoom={11} scrollWheelZoom={true}>\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n        <Markers />\r\n        <MapControl />\r\n      </MapContainer>\r\n      <Posts />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Map;\r\n"],"mappings":"AAAA,OAASA,YAAT,CAAuBC,SAAvB,CAAkCC,MAAlC,KAAgD,eAAhD,CACA,OAASC,MAAT,KAAuB,SAAvB,CACA,OAASC,SAAT,CAAoBC,WAApB,KAAuC,OAAvC,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,MAAO,iBAAP,CACA,MAAOC,QAAP,KAAoB,YAApB,CACA,MAAOC,MAAP,KAAkB,UAAlB,CACA,OAASC,WAAT,KAA4B,gCAA5B,CACA,OAASC,SAAT,KAA0B,2BAA1B,C,wFAEA,QAASC,WAAT,EAAsB,CACpB,GAAMC,SAAQ,CAAGP,WAAW,EAA5B,CACA,GAAMQ,aAAY,CAAGP,WAAW,CAAC,SAACQ,KAAD,QAAWA,MAAK,CAACD,YAAN,CAAmBA,YAA9B,EAAD,CAAhC,CACA,GAAME,IAAG,CAAGd,MAAM,EAAlB,CAEA,GAAMe,OAAM,CAAGZ,WAAW,CAAC,UAAM,CAC/B,GAAMa,OAAM,CAAGF,GAAG,CAACG,SAAJ,EAAf,CACA,GAAMC,OAAM,CAAG,EAAf,CACAN,YAAY,CAACO,OAAb,CAAqB,SAACC,IAAD,CAAU,CAC7B,GAAMC,IAAG,CAAGpB,MAAM,CAACmB,IAAI,CAACE,KAAL,CAAW,CAAX,CAAD,CAAgBF,IAAI,CAACE,KAAL,CAAW,CAAX,CAAhB,CAAlB,CACA,GAAIN,MAAM,CAACO,QAAP,CAAgBF,GAAhB,CAAJ,CAA0B,CACxBH,MAAM,CAACM,IAAP,CAAYJ,IAAZ,EACD,CACF,CALD,EAMAT,QAAQ,CAACH,WAAW,CAACU,MAAD,CAAZ,CAAR,CACD,CAVyB,CAUvB,CAACJ,GAAD,CAAMF,YAAN,CAVuB,CAA1B,CAYA,GAAMa,QAAO,CAAGtB,WAAW,CAAC,SAACuB,CAAD,CAAO,CACjC,GAAIC,SAAQ,CAAG,CAACD,CAAC,CAACE,MAAF,CAASC,GAAV,CAAeH,CAAC,CAACE,MAAF,CAASE,GAAxB,CAAf,CACAnB,QAAQ,CAACF,SAAS,CAACkB,QAAD,CAAV,CAAR,CACD,CAH0B,CAGxB,EAHwB,CAA3B,CAKAzB,SAAS,CAAC,UAAM,CACdY,GAAG,CAACiB,EAAJ,CAAO,MAAP,CAAehB,MAAf,EACAD,GAAG,CAACiB,EAAJ,CAAO,OAAP,CAAgBN,OAAhB,EACA,MAAO,WAAM,CACXX,GAAG,CAACkB,GAAJ,CAAQ,MAAR,CAAgBjB,MAAhB,EACAD,GAAG,CAACkB,GAAJ,CAAQ,OAAR,CAAiBP,OAAjB,EACD,CAHD,CAID,CAPQ,CAON,CAACX,GAAD,CAAMC,MAAN,CAPM,CAAT,CAQD,CAED,QAASkB,IAAT,EAAe,CACb,GAAMC,SAAQ,CAAG,CAAC,MAAD,CAAS,MAAT,CAAjB,CACA,mBACE,aAAK,SAAS,CAAC,eAAf,wBACE,MAAC,YAAD,EAAc,MAAM,CAAEA,QAAtB,CAAgC,IAAI,CAAE,EAAtC,CAA0C,eAAe,CAAE,IAA3D,wBACE,KAAC,SAAD,EACE,WAAW,CAAC,yFADd,CAEE,GAAG,CAAC,oDAFN,EADF,cAKE,KAAC,OAAD,IALF,cAME,KAAC,UAAD,IANF,GADF,cASE,KAAC,KAAD,IATF,GADF,CAaD,CAED,cAAeD,IAAf"},"metadata":{},"sourceType":"module"}